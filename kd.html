<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¿«é€’ä¸è®¢å•å½•å…¥</title>
  <style>
body {
  font-family: sans-serif;
  max-width: 600px;
  margin: auto;
  padding: 20px;
  background-color: #f2f2f2; /* âœ… æµ…ç°èƒŒæ™¯ */
}

h2 {
  text-align: center;
  font-size: 22px;
}

label {
  display: block;
  margin-top: 16px;
  font-weight: bold;
}

input, select, button {
  width: 100%;
  padding: 12px;
  font-size: 1rem;
  margin-top: 5px;
  box-sizing: border-box;
}

.input-group {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
}

.input-group input,
.input-group select {
  padding: 10px;
  font-size: 16px;
  border: 1px solid #ccc;
  border-radius: 4px;
  height: 42px;
  appearance: none;
  background-color: #fff;
  width: 100%;
}

.input-group select {
  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="5"><polygon points="0,0 10,0 5,5" fill="%23333"/></svg>');
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 10px 5px;
  padding-right: 30px;
}

/* âœ… è¡Œå®¹å™¨ï¼Œç”¨äº 2æ æˆ–3æ  */
.input-row {
  display: flex;
  gap: 16px;
  width: 100%;
  flex-wrap: wrap;
  box-sizing: border-box;
}

/* âœ… ä¸“ç”¨äºæ•°é‡/å•ä»·/è¿è´¹è¡Œ */
.input-row.fix-three .input-group {
  flex: 1 1 33.33%;
  min-width: 0;
}

/* âœ… æŒ‰é’®åŒºåŸŸ */
.btn-group {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 24px;
}

button.submit {
  border: none;
  color: white;
  border-radius: 6px;
}

.express { background: #28a745; }
.order { background: #007acc; }
.clear { background: #999; color: #fff; }

button:hover {
  opacity: 0.9;
  cursor: pointer;
}

/* âœ… å“åº”å¼æŒ‰é’®å¸ƒå±€ */
@media (min-width: 500px) {
  .btn-group {
    flex-direction: row;
    flex-wrap: wrap;
  }

  button.submit {
    flex: 1;
  }
}

/* âœ… è¡¨å•å¡ç‰‡å¤–æ¡† */
.form-container {
  max-width: 540px;
  margin: auto;
  background: #fffdf7;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}
.input-row.three-cols {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
}


  </style>
</head>
<body>
  <div class="form-container">
<h2>ğŸ“¦ å¿«é€’ä¸è®¢å•ç»Ÿä¸€å½•å…¥</h2>

<div class="input-row">
  <div class="input-group">
    <label for="orderNumber">è®¢å•å·</label>
    <input type="text" id="orderNumber">
  </div>
  <div class="input-group">
    <label for="customer">å®¢æˆ·åç§°</label>
    <select id="customer">
      <option value="">è¯·é€‰æ‹©å®¢æˆ·</option>
      <option value="å’ªé›ª">å’ªé›ª</option>
      <option value="Annie">Annie</option>
      <option value="HKS">HKS</option>
      <option value="JFL">JFL</option>
      <option value="é¾™">é¾™</option>
      <option value="æƒ ">æƒ </option>
      <option value="å§">å§</option>
      <option value="é˜¿å¦¹">é˜¿å¦¹</option>
      <option value="è‡ªå·±">è‡ªå·±</option>
      <option value="é˜¿æ–°">é˜¿æ–°</option>
      <option value="é—ºèœœ">é—ºèœœ</option>
    </select>
  </div>
</div>


<div class="input-row">
  <div class="input-group">
    <label for="trackingNumber">å¿«é€’å•å·</label>
    <input type="text" id="trackingNumber">
  </div>
  <div class="input-group">
    <label for="company">å¿«é€’å…¬å¸</label>
    <select id="company">
      <option value="">è¯·é€‰æ‹©å¿«é€’å…¬å¸</option>
      <option value="é¡ºä¸°">é¡ºä¸°</option>
      <option value="åœ†é€š">åœ†é€š</option>
      <option value="ä¸­é€š">ä¸­é€š</option>
      <option value="ç”³é€š">ç”³é€š</option>
      <option value="é‚®æ”¿">é‚®æ”¿</option>
      <option value="éŸµè¾¾">éŸµè¾¾</option>
      <option value="å¾·é‚¦">å¾·é‚¦</option>
      <option value="å®‰èƒ½">å®‰èƒ½</option>
      <option value="æå…”">æå…”</option>
      <option value="äº¬å¹¿">äº¬å¹¿</option>
      <option value="ä¼˜é€Ÿ">ä¼˜é€Ÿ</option>
      <option value="äº¬ä¸œ">äº¬ä¸œ</option>
      <option value="EMS">EMS</option>
    </select>
  </div>
</div>


<div class="input-row">
  <div class="input-group">
    <label for="product">å•†å“å</label>
    <input type="text" id="product">
  </div>
</div>

<div class="input-row three-cols">
  <div class="input-group">
    <label for="quantity">æ•°é‡</label>
    <input type="number" id="quantity">
  </div>
  <div class="input-group">
    <label for="price">å•ä»·</label>
    <input type="number" id="price">
  </div>
  <div class="input-group">
    <label for="foreignShipping">å¿«é€’è´¹</label>
    <input type="number" id="foreignShipping">
  </div>
</div>

<div id="summary" style="margin-top: 18px; font-weight: bold; text-align: right;">
  å°è®¡: <span id="subtotal">0.00</span>  | æ€»è®¡: <span id="total">0.00</span> 
</div>


<div class="btn-group">
  <button class="submit express" onclick="submitAsExpress()">ğŸ“¦ æäº¤å¿«é€’</button>
  <button class="submit order" onclick="submitAsOrder()">ğŸ§¾ æäº¤è®¢å•</button>
  <button class="submit clear" onclick="clearForm()">ğŸ§¼ æ¸…ç©ºè¡¨å•</button>
</div>

<script>
// æ›¿æ¢ä¸ºä½ è‡ªå·±çš„åœ°å€
const EXPRESS_URL = "https://wandering-moon-bdc2.jeenty.workers.dev/gas3";
const ORDER_URL = "https://wandering-moon-bdc2.jeenty.workers.dev/gas4";

function getField(id) {
  return document.getElementById(id).value.trim();
}

function parseOrZero(val) {
  return parseFloat(val) || 0;
}

function updateSummary() {
  const quantity = parseOrZero(getField("quantity"));
  const price = parseOrZero(getField("price"));
  const fee = parseOrZero(getField("foreignShipping"));
  const customer = getField("customer");

  const subtotal = quantity * price + fee;

  const markupMap = {
    "å’ªé›ª": 0.10, "Annie": 0.19, "HKS": 0.16, "JFL": 0.00,
    "é¾™": 0.00, "æƒ ": 0.00, "å§": 0.00, "é˜¿å¦¹": 0.00,
    "è‡ªå·±": 0.00, "é˜¿æ–°": 0.00
  };
  const markupRate = markupMap[customer] || 0;
  const total = (subtotal / 1.60) * (1 + markupRate);

  document.getElementById("subtotal").textContent = subtotal.toFixed(2);
  document.getElementById("total").textContent = total.toFixed(2);
}


function submitAsExpress() {
  const data = {
    customer: getField("customer"),
    orderNumber: getField("orderNumber"),
    trackingNumber: getField("trackingNumber"),
    company: getField("company"),
    product: getField("product")
  };

  fetch(EXPRESS_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(r => alert(r.message || "å¿«é€’ä¿¡æ¯æäº¤æˆåŠŸ"))
  .catch(() => alert("æäº¤å¤±è´¥"));
}

function submitAsOrder() {
  const data = {
    customer: getField("customer"),
    orderNumber: getField("orderNumber"),
    trackingNumber: getField("trackingNumber"),
    product: getField("product"),
    quantity: getField("quantity"),
    price: getField("price"),
    foreignShipping: getField("foreignShipping")
  };

  const qty = parseOrZero(data.quantity);
  const price = parseOrZero(data.price);
  const fee = parseOrZero(data.foreignShipping);
  const subtotal = qty * price + fee;
  data.subtotal = subtotal.toFixed(2);

  // ğŸ‘‡ å®¢æˆ·åŠ ä»·æ¯”ä¾‹
  const markupMap = {
    "å’ªé›ª": 0.10,
    "Annie": 0.19,
    "HKS": 0.16,
    "JFL": 0.00,
    "é¾™": 0.00,
    "æƒ ": 0.00,
    "å§": 0.00,
    "é˜¿å¦¹": 0.00,
    "è‡ªå·±": 0.00,
    "é˜¿æ–°": 0.00
  };
  const markupRate = markupMap[data.customer] || 0;
  const total = (subtotal / 1.60) * (1 + markupRate);
  data.total = total.toFixed(2);

  // ğŸ‘Œ çº¯æ•°å­—ç¡®è®¤ä¿¡æ¯
  if (!confirm(`ç¡®è®¤æäº¤è®¢å•ï¼Ÿ\næ•°é‡: ${qty} Ã— å•ä»·: ${price}\nè¿è´¹: ${fee}\n\nå°è®¡: ${data.subtotal}\næŠ˜ç®—æ€»è®¡: ${data.total}`)) {
    return;
  }

  fetch(ORDER_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(r => alert(r.message || "è®¢å•ä¿¡æ¯æäº¤æˆåŠŸ"))
  .catch(() => alert("æäº¤å¤±è´¥"));
}

function clearForm() {
  document.querySelectorAll("input, select").forEach(el => el.value = "");
  updateSummary(); // ğŸ’¡ æ¸…ç©ºåç«‹å³æ›´æ–°æ˜¾ç¤ºä¸º 0
}

// ç›‘å¬ç”¨æˆ·è¾“å…¥å˜åŒ–ï¼Œå®æ—¶åˆ·æ–°å°è®¡å’Œæ€»è®¡
["quantity", "price", "foreignShipping", "customer"].forEach(id => {
  document.getElementById(id).addEventListener("input", updateSummary);
  document.getElementById(id).addEventListener("change", updateSummary);
});

</script>
</div>

</body>
</html>
